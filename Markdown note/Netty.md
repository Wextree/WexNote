# Netty

##概述

官方定义为：”Netty 是一款**异步**的**事件驱动**的网络应用程序框架，支持快速地开发可维护的高性能的面向协议的服务器
和客户端”,按照惯例贴上一张High Level的架构图：

![](E:\git\WexNote\Markdown note\imgs\components.png)

Netty有很多重要的特性，主要**特性**如下：
- 优雅的设计
- 统一的API接口，支持多种传输类型，例如OIO,NIO
- 简单而强大的线程模型
- 丰富的文档
- 卓越的性能
- 拥有比原生Java API 更高的性能与更低的延迟
- 基于池化和复用技术，使资源消耗更低
- 安全性
- 完整的SSL/TLS以及StartTLS支持
- 可用于受限环境，如Applet以及OSGI



**原生NIO存在的问题：**
1、NIO的类库和API繁杂，使用麻烦：需要熟练掌握Selector 、ServerSocketChannel 、ByteBuffer等
2、需要具备其他的额外技能：要熟悉Java多线程编程，因为NIO涉及到Reactor模式，你必须对多线程和网络编程非常熟悉，才能编写出高质量的NIO程序
3、开发工作量和难度都非常大：例如客户端面临断连重连、网络闪断、半包读写、失败缓冲、网络拥塞和异常流的处理等等。
4、JDK NIO的bug：例如臭名昭著的Epoll Bug ,它会导致Selector空轮询，最终导致CPU100%.直到JDK1.7版本该问题仍旧存在，没有被根本解决。

## 架构设计

### 传统IO阻塞模型

![](E:\git\WexNote\Markdown note\imgs\1591968096.jpg)



**特点：**

- 采用阻塞IO获取输入的数据。
- 每个连接都需要独立的线程来获取数据的输入，业务处理，数据返回。



**问题：**

- 当并发数很大的时候，会占用大量的线程和大量的系统资源你。
- 当线程没有数据可读的时候，会阻塞在read操作中，造成线程资源的浪费。



### Reactor模式（反应器、分发者、通知者）

I/O复用结合线程池的基本设计思想。

1. 通过一个或多个输入同时传递给服务处理器的模式（基于事件驱动）。
2. 服务器端程序处理传入的多个请求，并将它们同步分派到相应的处理线程。
3. Reactor使用了IO复用监听事件。收到事件后进行分发给某个线程。（是网络处理高并发的关键）



- **单Reactor单线程**





























